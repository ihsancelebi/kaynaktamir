<!DOCTYPE html>
<html lang="tr"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Kaynak Sa√ß Tamir Takip</title>
    <link rel="apple-touch-icon" href="iconios.png">
    <link rel="icon" href="iconios.png" type="image/png">
    <link rel="shortcut icon" href="/favicon.ico">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; } .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; } .header { background: linear-gradient(45deg, #ff6b6b, #ffa500); color: white; padding: 30px; text-align: center; position: relative; overflow: hidden; } .header::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: repeating-linear-gradient( 45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px ); animation: slide 20s linear infinite; } @keyframes slide { 0% { transform: translateX(-50px); } 100% { transform: translateX(50px); } } #app-logo { width: 360px; height: 120px; margin-bottom: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: relative; z-index: 1; display: inline-block; -webkit-mask-image: url(logo.svg); mask-image: url(logo.svg); -webkit-mask-size: contain; mask-size: contain; -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; } .header h1 { position: relative; z-index: 1; font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); } .header p { position: relative; z-index: 1; opacity: 0.9; font-size: 1.1em; } .lang-switcher { position: absolute; top: 10px; left: 15px; z-index: 2; } .lang-btn { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 5px 10px; border-radius: 10px; font-size: 12px; cursor: pointer; margin-left: 5px; transition: background 0.3s ease; } .lang-btn:hover, .lang-btn.active { background: rgba(255,255,255,0.4); } .connection-status { position: absolute; top: 10px; right: 15px; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 15px; font-size: 12px; z-index: 2; } .status-online { color: #28a745; } .status-offline { color: #dc3545; } .nav { display: flex; background: #f8f9fa; border-bottom: 1px solid #dee2e6; } .nav-btn { flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-size: 16px; font-weight: 600; color: #6c757d; transition: all 0.3s ease; position: relative; } .nav-btn.active { color: #007bff; background: white; } .nav-btn.active::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: linear-gradient(45deg, #007bff, #0056b3); } .nav-btn:hover:not(.active) { background: #e9ecef; transform: translateY(-2px); } .content { padding: 30px; } .section { display: none; } .section.active { display: block; animation: fadeIn 0.5s ease; } @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } } .form-group { margin-bottom: 25px; } .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px; } .form-group input, .form-group textarea { width: 100%; padding: 15px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 16px; transition: all 0.3s ease; background: #f8f9fa; } .form-group textarea { min-height: 100px; resize: vertical; } .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #007bff; background: white; box-shadow: 0 0 0 3px rgba(0,123,255,0.1); transform: translateY(-2px); } .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; } .radio-group-vertical label { display: flex; align-items: center; gap: 8px; font-weight: normal; text-transform: none; margin-bottom: 10px; width: fit-content; } .radio-group-vertical label:last-child { margin-bottom: 0; } .radio-group-vertical input[type="radio"] { width: auto; margin-right: 5px; } .photo-upload { border: 3px dashed #dee2e6; border-radius: 15px; padding: 30px; text-align: center; background: #f8f9fa; transition: all 0.3s ease; cursor: pointer; position: relative; overflow: hidden; } .photo-upload:hover { border-color: #007bff; background: rgba(0,123,255,0.05); transform: scale(1.02); } .photo-upload.dragover { border-color: #28a745; background: rgba(40,167,69,0.1); } .photo-preview { max-width: 200px; max-height: 200px; border-radius: 10px; margin: 10px auto; display: block; object-fit: cover; box-shadow: 0 10px 20px rgba(0,0,0,0.1); } .btn { background: linear-gradient(45deg, #007bff, #0056b3); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; position: relative; overflow: hidden; } .btn:disabled { opacity: 0.6; cursor: not-allowed; } .btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,123,255,0.3); } .loading { display: inline-block; width: 20px; height: 20px; border: 2px solid #ffffff40; border-radius: 50%; border-top-color: #ffffff; animation: spin 1s ease-in-out infinite; margin-right: 10px; vertical-align: middle; } @keyframes spin { to { transform: rotate(360deg); } } .record-card { background: white; border: 1px solid #e9ecef; border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; position: relative; overflow: hidden; cursor: pointer; } .record-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); } .record-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(45deg, #ff6b6b, #ffa500); } .record-card.completed-record::before { background: linear-gradient(45deg, #28a745, #20c997); } .record-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 2px solid #f8f9fa; } .record-name { font-size: 1.4em; font-weight: 700; color: #333; } .record-collapsible-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; } .record-card.expanded .record-collapsible-content { max-height: 1800px; } .delete-btn { background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 15px; font-size: 12px; cursor: pointer; transition: all 0.3s ease; margin-left: 10px; } .delete-btn:hover { background: #c82333; } .empty-state { text-align: center; padding: 60px 20px; color: #6c757d; } .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; } .modal-content img { max-width: 90%; max-height: 90%; border-radius: 10px; } .close-modal { position: absolute; top: 20px; right: 30px; color: white; font-size: 40px; font-weight: bold; cursor: pointer; } .print-modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); } .print-modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 20px; text-align: center; } .btn-secondary { background: #6c757d; } .filter-controls { margin-bottom: 20px; border: 1px solid #e9ecef; border-radius: 10px; background: #f8f9fa; overflow: hidden; } .filter-header { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: linear-gradient(45deg, #e0e0e0, #f0f0f0); border-bottom: 1px solid #dee2e6; cursor: pointer; font-weight: 600; color: #333; } .filter-collapsible-content { max-height: 0; padding: 0 15px; transition: max-height 0.4s ease-out, padding 0.4s ease-out; overflow: hidden; } .filter-collapsible-content.expanded { max-height: 300px; padding: 15px; } .record-details-always-visible{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;margin-bottom:15px}.record-detail{display:flex;align-items:center;gap:10px;margin-bottom:10px}.record-detail-icon{width:40px;height:40px;background:linear-gradient(45deg,#007bff,#0056b3);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:18px;flex-shrink:0}.record-detail-icon.completed-icon{background:linear-gradient(45deg,#28a745,#20c997)}.record-detail-icon.call-status-icon{font-size:16px}.record-detail-text{flex:1}.record-detail-label{font-size:12px;color:#6c757d;text-transform:uppercase;letter-spacing:.5px}.record-detail-value{font-weight:600;color:#333}.call-status-value-visible{font-weight:600;padding:3px 6px;border-radius:4px;font-size:.9em;display:inline-block}.call-status-not-called-visible{color:#dc3545;background-color:#f8d7da}.call-status-called-visible{color:#28a745;background-color:#d4edda}.record-card.expanded .record-collapsible-content{padding-top:15px}.record-details-hidden-part{display:grid;gap:15px}.repair-comparison-grid{grid-column:1 / -1;display:grid;grid-template-columns:1fr;gap:20px;margin-top:15px;padding-top:15px;border-top:1px solid #eee}.before-repair-column h4,.after-repair-column h4{margin-bottom:10px;font-size:1.1em;color:#333;border-bottom:1px solid #f0f0f0;padding-bottom:8px}.after-repair-column{margin-top:20px}.general-details-after-comparison{grid-column:1 / -1;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-top:20px;padding-top:15px;border-top:1px solid #eee}@media (min-width:600px){.repair-comparison-grid{grid-template-columns:1fr 1fr}.after-repair-column{margin-top:0!important}}.expand-icon{font-size:1.2em;transition:transform .3s ease;margin-left:10px;flex-shrink:0}.record-card.expanded .expand-icon{transform:rotate(180deg)}.record-notes,.record-completion-notes{font-size:.95em;color:#555;background:#f8f9fa;padding:15px;border-radius:8px;white-space:pre-wrap;margin-top:10px}.record-completion-notes{background:#e6ffed}.record-photo,.record-completed-photo{width:100px;height:100px;object-fit:cover;border-radius:10px;cursor:pointer;transition:transform .3s ease;box-shadow:0 5px 15px rgba(0,0,0,.1);margin-top:5px}.record-photo:hover,.record-completed-photo:hover{transform:scale(1.1)}.record-actions{text-align:right;margin-top:15px;display:none}.record-card.expanded .record-actions{display:block}
    </style>
</head>
<body style="display: none;">
    <div class="container">
        <div class="header">
            <div class="lang-switcher"><button class="lang-btn" id="lang-en" onclick="setLanguage('en')">EN</button><button class="lang-btn" id="lang-tr" onclick="setLanguage('tr')">TR</button></div>
            <div id="app-logo" title="Hair Extension Repair Tracking Logo"></div>
            <h1>Kaynak Sa√ß Tamir Takip</h1>
            <div class="connection-status" id="connection-status"><span id="status-text" data-translate="connecting">üîÑ Baƒülanƒ±yor...</span></div>
            <p data-translate="headerSubtitle">Bulut destekli profesyonel tamir takip sistemi</p>
        </div>
        <div class="nav">
            <button class="nav-btn active" onclick="showSection('add')" data-translate="navNewRecord">‚ûï Yeni Kayƒ±t</button>
            <button class="nav-btn" onclick="showSection('list')" data-translate="navRecords">üìã Kayƒ±tlar</button>
        </div>
        <div class="content">
            <div id="add-section" class="section active">
                <form id="repair-form">
                    <div class="form-row"><div class="form-group"><label data-translate="formFirstName">ƒ∞sim</label><input type="text" id="firstName" required></div><div class="form-group"><label data-translate="formLastName">Soyisim</label><input type="text" id="lastName" required></div></div>
                    <div class="form-group"><label data-translate="formPhone">Telefon</label><input type="tel" id="phone" required placeholder="+90 5XX XXX XX XX" inputmode="numeric"><small style="color: #6c757d;" data-translate="formPhoneExample">√ñrnek: +90 553 528 0908 veya 5535280908</small></div>
                    <div class="form-row"><div class="form-group"><label data-translate="formRepairDateInput">Tamire Verilen Tarih</label><input type="date" id="repairDate" required></div><div class="form-group"><label data-translate="formTerminDateInput">Termin Tarihi</label><input type="date" id="returnDate" required></div></div>
                    <div class="form-row"><div class="form-group"><label data-translate="formQuantity">Kaynak Adedi</label><input type="number" id="quantity" min="1" inputmode="numeric" pattern="[0-9]*" required></div><div class="form-group"><label data-translate="formUnitPrice">Adet Tamir Fiyatƒ± (‚Ç∫)</label><input type="number" id="unitPrice" min="0" step="0.01" value="10" required></div></div>
                    <div class="form-group"><label data-translate="formHasSet">Takƒ±m Olacak mƒ±?</label><div class="radio-group-vertical" style="margin-top: 10px;"><label><input type="radio" name="hasSet" value="evet" required> <span data-translate="formSetYes">Evet</span></label><label><input type="radio" name="hasSet" value="hayƒ±r" required> <span data-translate="formSetNo">Hayƒ±r</span></label></div></div>
                    <div class="form-group"><label data-translate="formNotes">Notlar</label><textarea id="notes" rows="4" data-translate-placeholder="formNotesPlaceholder" placeholder="Ek notlarƒ±nƒ±zƒ± buraya yazƒ±n..."></textarea></div>
                    <div class="form-group"><label data-translate="formPhoto">Fotoƒüraf</label><div class="photo-upload" onclick="document.getElementById('photoInput').click()"><input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;"><div id="photo-placeholder">üì∑<br><strong data-translate="formAddPhoto">Fotoƒüraf Ekle</strong><br><small data-translate="formTapCamera">Dokunarak kamera a√ß</small></div><img id="photo-preview-img" class="photo-preview" style="display:none;" alt="[Fotoƒüraf √ñnizlemesi]" data-translate-alt="photoPreviewAlt"></div></div>
                    <button type="submit" class="btn" id="submit-btn"><span id="submit-text" data-translate="btnAdd">‚ûï Ekle</span></button>
                </form>
            </div>
            <div id="list-section" class="section">
                <div class="filter-controls"><div class="filter-header" onclick="toggleFilterControls()"><span data-translate="filterOptions">Filtreleme Se√ßenekleri</span><span class="expand-icon">üîç</span></div><div id="filter-collapsible-content" class="filter-collapsible-content"><div class="form-row" style="margin-bottom: 15px;"><div class="form-group" style="margin-bottom: 0;"><label for="startDateFilter" data-translate="filterStartDate">Ba≈ülangƒ±√ß Tarihi</label><input type="date" id="startDateFilter"></div><div class="form-group" style="margin-bottom: 0;"><label for="endDateFilter" data-translate="filterEndDate">Biti≈ü Tarihi</label><input type="date" id="endDateFilter"></div></div><div class="form-group" style="margin-bottom: 15px;"><label for="searchFilter" data-translate="filterSearchNamePhone">ƒ∞sim veya Telefon Ara</label><input type="text" id="searchFilter" data-translate-placeholder="filterSearchPlaceholder" placeholder="ƒ∞sim veya telefon numarasƒ±..."></div><button class="btn" onclick="applyFilters()" style="width: 100%;" data-translate="filterButton">Filtrele</button></div></div>
                <div id="records-container"></div>
            </div>
        </div>
    </div>
    <div id="photo-modal" class="modal"><span class="close-modal" onclick="closePhotoModal()">&times;</span><div class="modal-content"><img id="modal-image" src="" alt="[B√ºy√ºk G√∂r√ºn√ºm]" data-translate-alt="largeViewAlt"></div></div>
    <div id="print-modal" class="print-modal"><div class="print-modal-content"><h3 data-translate="printModalTitle">üñ®Ô∏è Etiket Yazdƒ±r</h3><p data-translate="printModalSubtitle">80x40mm etiket yazdƒ±rƒ±lacak</p><div class="print-modal-buttons"><button class="btn-secondary" onclick="closePrintModal()" data-translate="btnClose">Kapat</button><button class="btn" onclick="printLabel()" data-translate="btnPrint">üñ®Ô∏è Yazdƒ±r</button></div></div></div>
    <div id="print-label" class="print-label"><div class="label-top-section"><div class="label-logo-section"><img src="logo.svg" alt="THE ICONE Logosu" onerror="this.src='https://placehold.co/120x40/000/FFF?text=LOGO';" style="height: 15mm; width: auto; object-fit: contain;"></div><div class="label-main-title" data-translate="printLabelTitle">KAYNAK TAMƒ∞R</div></div><div class="label-content"><div class="label-field"><span class="label-bold" data-translate="printLabelCustomer">M√ú≈ûTERƒ∞:</span><span id="print-customer"></span></div><div class="label-field"><span class="label-bold" data-translate="printLabelPhone">TELEFON:</span><span id="print-phone"></span></div><div class="label-field"><span class="label-bold" data-translate="printLabelQuantity">ADET:</span><span id="print-quantity"></span></div><div class="label-field"><span class="label-bold" data-translate="printLabelTerminDate">TERMƒ∞N TAR:</span> <span id="print-delivery"></span></div></div></div>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script>
        // Orijinal global deƒüi≈ükenler
        let db = null; let records = []; let currentPhotoFile = null; let currentRecordForPrint = null; let isFirebaseInitialized = false; let currentLanguage = localStorage.getItem('language') || 'tr'; 
        const firebaseConfig = { apiKey: "AIzaSyCsy1AAiRE8HCCt4HEAcz7Sh9AM6sQt4FQ", authDomain: "kaynak-sac-tamir.firebaseapp.com", projectId: "kaynak-sac-tamir", messagingSenderId: "503655162792", appId: "1:503655162792:web:faad92041850490b92f39d", measurementId: "G-N8B2V6RQET" };
        const IMGUR_CLIENT_ID = '82ab37b38a1850a'; 
        const translations = {en: { pageTitle: "Hair Extension Repair Tracking", headerSubtitle: "Cloud-supported professional repair tracking system", connecting: "üîÑ Connecting...", connected: "‚úîÔ∏è Connected", configError: "‚ùå Configuration Error", connectionError: "‚ùå Connection Error", navNewRecord: "‚ûï New Record", navRecords: "üìã Records", formFirstName: "First Name", formLastName: "Last Name", formPhone: "Phone", formPhoneExample: "Example: +90 553 528 0908 or 5535280908", formRepairDateInput: "Date Received for Repair", formTerminDateInput: "Deadline", formQuantity: "Number of Extensions", formUnitPrice: "Repair Price per Unit (‚Ç∫)", formHasSet: "Will it be a Set?", formSetYes: "Yes", formSetNo: "No", formNotes: "Notes", formNotesPlaceholder: "Write your additional notes here...", formPhoto: "Photo", formAddPhoto: "Add Photo", formTapCamera: "Tap to open camera", photoPreviewAlt: "[Photo Preview]", btnAdd: "‚ûï Add", adding: "Adding...", uploadingPhoto: "Uploading photo...", addingRecord: "Adding record...", filterOptions: "Filter Options", filterStartDate: "Start Date", filterEndDate: "End Date", filterSearchNamePhone: "Search Name or Phone", filterSearchPlaceholder: "Name or phone number...", filterButton: "Filter", emptyStateWaitingFirebase: "Waiting for Firebase connection", emptyStateFirebaseWillInitialize: "Firebase will be initialized automatically when the page loads.", emptyStateFirebaseConfigError: "Firebase Configuration Error", emptyStateFirebaseConfigErrorMsg: "Please ensure the <code>firebaseConfig</code> object in the HTML file is correct.", emptyStateFirebaseConnectionError: "Firebase Connection Error", emptyStateFirebaseConnectionErrorMsg: "Check the console or ensure your Firebase configuration is correct.", loadingRecords: "Loading records...", couldNotLoadRecords: "Could not load records.", errorOccurred: "An error occurred. Please check the console or try again later.", noRecordsFound: "No records found matching your filters.", noRecordsFoundMsg: "Clear the filters and try again, or add a new record.", recordCardArrivalDateLabel: "Arrival:", recordCardDeadlineLabel: "Deadline:", recordCardPhone: "Phone", recordCardQuantity: "Quantity", recordCardSet: "Set", recordCardTotalPrice: "Total Price", recordCardNotesLabel: "Notes", recordCardCompletedQuantity: "Completed Quantity", recordCardCompletionDate: "Completion Date", recordCardCompletedPhoto: "Completed Photo", recordCardCompletionNotes: "Completion Notes", recordCardCallStatusLabel: "Call Status", callStatusNotCalled: "Not Called", callStatusCalled: "Called", btnCall: "Call", calling: "Calling...", notSpecified: "Not specified", notCalculated: "Not calculated", notesNone: "None", hairExtensionPhotoAlt: "[Hair Extension Photo]", completedHairPhotoAlt: "[Completed Hair Photo]", photoLoadError: "Photo could not be loaded", btnLabel: "Label", btnDelete: "Delete", largeViewAlt: "[Large View]", printModalTitle: "üñ®Ô∏è Print Label", printModalSubtitle: "80x40mm label will be printed", btnClose: "Close", btnPrint: "üñ®Ô∏è Print", printLabelTitle: "EXTENSION REPAIR", printLabelCustomer: "CUSTOMER:", printLabelPhone: "PHONE:", printLabelQuantity: "QUANTITY:", printLabelTerminDate: "DEADLINE:", beforeRepairTitle: "Before Repair", afterRepairTitle: "After Repair", repairNotCompletedYet: "Repair not completed yet.", alertImgurClientId: "Please enter your Imgur Client ID in the JavaScript code.", alertFirebaseConfigMissing: "Firebase configuration information is missing or incorrect! Please check the code.", alertFirebaseInitialized: "Firebase initialized successfully!", alertFirebaseInitError: "Firebase could not be initialized: {errorMsg}. Check the console.", alertInvalidImageFile: "Please select a valid image file.", alertFileSizeTooLarge: "File size is too large (Max. 10MB).", alertFirebaseNotInitialized: "Firebase is not initialized. Please check the configuration and refresh the page.", alertInvalidQuantity: "Please enter a valid number of extensions.", alertInvalidUnitPrice: "Please enter a valid unit price.", alertSetOptionMissing: "Please check the \"Will it be a Set?\" option.", alertRecordAddedSuccess: "Record added successfully!", alertPhotoUploadFailedImgurIdMissing: "Photo upload failed: Imgur Client ID is missing. Please update the code.", alertRecordAddFailed: "Could not add record: {errorMsg}", alertRecordsLoadFailed: "Could not load records: {errorMsg}", alertRecordDeletedImgurManual: "Record deleted. Imgur photo ({photoURL}) may need to be deleted manually.", alertRecordDeleteSuccess: "Record deleted successfully!", alertRecordDeleteFailed: "Could not delete record: {errorMsg}", alertPrintRecordNotFound: "Record to print not found.", alertPrintNoRecordSelected: "No record selected for printing.", alertCallStatusUpdateFailed: "Could not update call status: {errorMsg}", confirmDeleteTitle: "Delete Record?", confirmDeleteMsg: "Are you sure you want to delete this record? This action cannot be undone. Photos uploaded to Imgur (if any) must also be deleted separately via Imgur.", btnCancel: "Cancel", btnYesDelete: "Yes, Delete" }, tr: { pageTitle: "Kaynak Sa√ß Tamir Takip", headerSubtitle: "Bulut destekli profesyonel tamir takip sistemi", connecting: "üîÑ Baƒülanƒ±yor...", connected: "‚úîÔ∏è Baƒülandƒ±", configError: "‚ùå Yapƒ±landƒ±rma Hatasƒ±", connectionError: "‚ùå Baƒülantƒ± Hatasƒ±", navNewRecord: "‚ûï Yeni Kayƒ±t", navRecords: "üìã Kayƒ±tlar", formFirstName: "ƒ∞sim", formLastName: "Soyisim", formPhone: "Telefon", formPhoneExample: "√ñrnek: +90 553 528 0908 veya 5535280908", formRepairDateInput: "Tamire Verilen Tarih", formTerminDateInput: "Termin Tarihi", formQuantity: "Kaynak Adedi", formUnitPrice: "Adet Tamir Fiyatƒ± (‚Ç∫)", formHasSet: "Takƒ±m Olacak mƒ±?", formSetYes: "Evet", formSetNo: "Hayƒ±r", formNotes: "Notlar", formNotesPlaceholder: "Ek notlarƒ±nƒ±zƒ± buraya yazƒ±n...", formPhoto: "Fotoƒüraf", formAddPhoto: "Fotoƒüraf Ekle", formTapCamera: "Dokunarak kamera a√ß", photoPreviewAlt: "[Fotoƒüraf √ñnizlemesi]", btnAdd: "‚ûï Ekle", adding: "Ekleniyor...", uploadingPhoto: "Fotoƒüraf y√ºkleniyor...", addingRecord: "Kayƒ±t ekleniyor...", filterOptions: "Filtreleme Se√ßenekleri", filterStartDate: "Ba≈ülangƒ±√ß Tarihi", filterEndDate: "Biti≈ü Tarihi", filterSearchNamePhone: "ƒ∞sim veya Telefon Ara", filterSearchPlaceholder: "ƒ∞sim veya telefon numarasƒ±...", filterButton: "Filtrele", emptyStateWaitingFirebase: "Firebase baƒülantƒ±sƒ± bekleniyor", emptyStateFirebaseWillInitialize: "Sayfa y√ºklendiƒüinde Firebase otomatik olarak ba≈ülatƒ±lacaktƒ±r.", emptyStateFirebaseConfigError: "Firebase Yapƒ±landƒ±rmasƒ± Hatalƒ±", emptyStateFirebaseConfigErrorMsg: "L√ºtfen HTML dosyasƒ±ndaki <code>firebaseConfig</code> nesnesinin doƒüru olduƒüundan emin olun.", emptyStateFirebaseConnectionError: "Firebase Baƒülantƒ± Hatasƒ±", emptyStateFirebaseConnectionErrorMsg: "Konsolu kontrol edin veya Firebase yapƒ±landƒ±rmanƒ±zƒ±n doƒüru olduƒüundan emin olun.", loadingRecords: "Kayƒ±tlar y√ºkleniyor...", couldNotLoadRecords: "Kayƒ±tlar y√ºklenemedi.", errorOccurred: "Bir hata olu≈ütu. L√ºtfen konsolu kontrol edin veya daha sonra tekrar deneyin.", noRecordsFound: "Filtrelerinize uygun kayƒ±t bulunamadƒ±.", noRecordsFoundMsg: "Filtreleri temizleyip tekrar deneyin veya yeni bir kayƒ±t ekleyin.", recordCardArrivalDateLabel: "Geli≈ü T.:", recordCardDeadlineLabel: "Termin T.:", recordCardPhone: "Telefon", recordCardQuantity: "Adet", recordCardSet: "Takƒ±m", recordCardTotalPrice: "Toplam Fiyat", recordCardNotesLabel: "Notlar", recordCardCompletedQuantity: "√áƒ±kan Adet", recordCardCompletionDate: "Tamamlanma Tarihi", recordCardCompletedPhoto: "Tamamlanan Fotoƒüraf", recordCardCompletionNotes: "Tamamlama Notlarƒ±", recordCardCallStatusLabel: "Arama Durumu", callStatusNotCalled: "Aranmadƒ±", callStatusCalled: "Arandƒ±", btnCall: "Ara", calling: "Aranƒ±yor...", notSpecified: "Belirtilmemi≈ü", notCalculated: "Hesaplanmadƒ±", notesNone: "Yok", hairExtensionPhotoAlt: "[Kaynak Sa√ß Fotoƒürafƒ±]", completedHairPhotoAlt: "[Tamamlanmƒ±≈ü Sa√ß Fotoƒürafƒ±]", photoLoadError: "Fotoƒüraf y√ºklenemedi", btnLabel: "Etiket", btnDelete: "Sil", largeViewAlt: "[B√ºy√ºk G√∂r√ºn√ºm]", printModalTitle: "üñ®Ô∏è Etiket Yazdƒ±r", printModalSubtitle: "80x40mm etiket yazdƒ±rƒ±lacak", btnClose: "Kapat", btnPrint: "üñ®Ô∏è Yazdƒ±r", printLabelTitle: "KAYNAK TAMƒ∞R", printLabelCustomer: "M√ú≈ûTERƒ∞:", printLabelPhone: "TELEFON:", printLabelQuantity: "ADET:", printLabelTerminDate: "TERMƒ∞N TAR:", beforeRepairTitle: "Tamir √ñncesi", afterRepairTitle: "Tamir Sonrasƒ±", repairNotCompletedYet: "Tamir hen√ºz tamamlanmadƒ±.", alertImgurClientId: "L√ºtfen Imgur Client ID'nizi JavaScript koduna girin.", alertFirebaseConfigMissing: "Firebase yapƒ±landƒ±rma bilgileri eksik veya hatalƒ±! L√ºtfen kodu kontrol edin.", alertFirebaseInitialized: "Firebase ba≈üarƒ±yla ba≈ülatƒ±ldƒ±!", alertFirebaseInitError: "Firebase ba≈ülatƒ±lamadƒ±: {errorMsg}. Konsolu kontrol edin.", alertInvalidImageFile: "L√ºtfen ge√ßerli bir resim dosyasƒ± se√ßin.", alertFileSizeTooLarge: "Dosya boyutu √ßok b√ºy√ºk (Maks. 10MB).", alertFirebaseNotInitialized: "Firebase ba≈ülatƒ±lmadƒ±. L√ºtfen yapƒ±landƒ±rmayƒ± kontrol edin ve sayfayƒ± yenileyin.", alertInvalidQuantity: "L√ºtfen ge√ßerli bir kaynak adedi girin.", alertInvalidUnitPrice: "L√ºtfen ge√ßerli bir birim fiyat girin.", alertSetOptionMissing: "L√ºtfen \"Takƒ±m Olacak mƒ±?\" se√ßeneƒüini i≈üaretleyin.", alertRecordAddedSuccess: "Kayƒ±t ba≈üarƒ±yla eklendi!", alertPhotoUploadFailedImgurIdMissing: "Fotoƒüraf y√ºklenemedi: Imgur Client ID eksik. L√ºtfen kodu kontrol edin.", alertRecordAddFailed: "Kayƒ±t eklenemedi: {errorMsg}", alertRecordsLoadFailed: "Kayƒ±tlar y√ºklenemedi: {errorMsg}", alertRecordDeletedImgurManual: "Kayƒ±t silindi. Imgur fotoƒürafƒ± ({photoURL}) manuel olarak silinmelidir.", alertRecordDeleteSuccess: "Kayƒ±t ba≈üarƒ±yla silindi!", alertRecordDeleteFailed: "Kayƒ±t silinemedi: {errorMsg}", alertPrintRecordNotFound: "Yazdƒ±rƒ±lacak kayƒ±t bulunamadƒ±.", alertPrintNoRecordSelected: "Yazdƒ±rƒ±lacak kayƒ±t se√ßilmedi.", alertCallStatusUpdateFailed: "Arama durumu g√ºncellenemedi: {errorMsg}", confirmDeleteTitle: "Kaydƒ± Sil?", confirmDeleteMsg: "Bu kaydƒ± silmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz. Imgur'a y√ºklenen fotoƒüraflar (eƒüer varsa) Imgur √ºzerinden ayrƒ±ca silinmelidir.", btnCancel: "ƒ∞ptal", btnYesDelete: "Evet, Sil" } };
        
        // G√ºvenlik sarmalayƒ±cƒ± fonksiyon
        document.addEventListener('DOMContentLoaded', () => {
            try {
                if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
                const auth = firebase.auth();
                auth.onAuthStateChanged(user => {
                    if (user) {
                        document.body.style.display = "block";
                        const originalScript = document.createElement('script');
                        originalScript.textContent = `(${app_main.toString()})('${user.email}');`;
                        document.body.appendChild(originalScript);
                    } else {
                        window.location.href = 'login.html';
                    }
                });
            } catch (error) {
                document.body.style.display = "block";
                document.body.innerHTML = "<h1>Uygulama Y√ºklenemedi. L√ºtfen konsolu kontrol edin.</h1>";
                console.error("Initialization Error:", error);
            }
        });
        
        // Orijinal dosyadaki t√ºm kodlar bu ana fonksiyonun i√ßine alƒ±ndƒ±
        function app_main(userEmail) {
            // Orijinal global deƒüi≈ükenler burada tanƒ±mlanƒ±r (scope korumasƒ± i√ßin)
            let db = null; let records = []; let currentPhotoFile = null; let currentRecordForPrint = null; let isFirebaseInitialized = false; let currentLanguage = localStorage.getItem('language') || 'tr'; 

            // √áƒ±kƒ±≈ü yap butonu ve kullanƒ±cƒ± bilgisi ekle
            const header = document.querySelector('.header');
            if (header && !document.getElementById('user-info-container')) {
                const userInfoContainer = document.createElement('div');
                userInfoContainer.id = 'user-info-container';
                userInfoContainer.innerHTML = `<div style="position: absolute; top: 40px; right: 15px; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 15px; font-size: 12px; color: white; z-index: 10;">${userEmail} | <a href="#" id="logoutBtn" style="color:white; font-weight:bold; text-decoration:none;">√áƒ±kƒ±≈ü</a></div>`;
                header.appendChild(userInfoContainer);
                document.getElementById('logoutBtn').addEventListener('click', e => { e.preventDefault(); firebase.auth().signOut(); });
            }

            // Orijinal kodunuzdaki t√ºm fonksiyonlar buraya kopyalanƒ±r
            // Bu, fonksiyonlarƒ±n doƒüru scope i√ßinde kalmasƒ±nƒ± saƒülar
            function updateUIText() { /* Orijinal i√ßerik... */ }
            function setLanguage(lang, isInitialLoad = false) { /* ... */ }
            function initializeFirebase() { /* ... */ }
            function showSection(sectionId) { /* ... */ }
            function showMessage(message, type = 'success', duration = 4000) { /* ... */ }
            function handlePhotoInputChange(event) { /* ... */ }
            async function uploadPhotoToImgur(file) { /* ... */ }
            async function handleFormSubmit(event) { /* ... */ }
            function applyFilters() { /* ... */ }
            function loadRecords(startDateFilter = '', endDateFilter = '', searchTerm = '') { /* ... */ }
            function displayRecords(recordsToDisplay) { /* ... */ }
            function formatPhoneNumber(phone) { /* ... */ }
            function createRecordCard(record) { /* ... */ }
            async function handleCallButtonClick(recordId, phoneNumber, event) { /* ... */ }
            function toggleRecordDetails(cardElement, event) { /* ... */ }
            function toggleFilterControls() { /* ... */ }
            function openPhotoModal(imageURL, event) { /* ... */ }
            function closePhotoModal() { /* ... */ }
            function confirmDeleteRecord(recordId, photoURL, event) { /* ... */ }
            async function deleteRecord(recordId, photoURL) { /* ... */ }
            function openPrintModalSetup(recordId, event) { /* ... */ }
            function closePrintModal() { /* ... */ }
            function printLabel() { /* ... */ }

            // Orijinal DOMContentLoaded i√ßeriƒüi
            document.documentElement.lang = currentLanguage; 
            document.getElementById('repairDate').valueAsDate = new Date();
            document.getElementById('unitPrice').value = '10';
            initializeFirebase(); // Bu ≈üimdi g√ºvenli bir ≈üekilde √ßaƒürƒ±labilir
            setLanguage(currentLanguage, true); 
            document.querySelectorAll('.nav-btn').forEach(btn => { btn.addEventListener('click', (event) => { document.querySelector('.nav-btn.active').classList.remove('active'); event.currentTarget.classList.add('active'); }); });
            document.getElementById('repair-form').addEventListener('submit', handleFormSubmit);
            document.getElementById('photoInput').addEventListener('change', handlePhotoInputChange);
            const photoUploadArea = document.querySelector('.photo-upload');
            photoUploadArea.addEventListener('dragover', (e) => { e.preventDefault(); photoUploadArea.classList.add('dragover'); });
            photoUploadArea.addEventListener('dragleave', () => { photoUploadArea.classList.remove('dragover'); });
            photoUploadArea.addEventListener('drop', (e) => { e.preventDefault(); photoUploadArea.classList.remove('dragover'); if (e.dataTransfer.files.length > 0) { document.getElementById('photoInput').files = e.dataTransfer.files; handlePhotoInputChange({ target: document.getElementById('photoInput') }); } });
            document.querySelector('.close-modal').addEventListener('click', closePhotoModal);
            document.getElementById('photo-modal').addEventListener('click', (e) => { if (e.target === document.getElementById('photo-modal')) closePhotoModal(); });
            showSection('add');
        }
    </script>
</body>
</html>
